
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!-- Include the CesiumJS JavaScript and CSS files -->
    <script src="../Cesium/Build/Cesium/Cesium.js"></script>
    <link href="../Cesium/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <link href="Style.css" rel="stylesheet">

</head>
<body>
<div id="cesiumContainer"></div>
<div class="cesium-viewer-toolbar"></div>
<div id="buttonDiv"></div>
<script src="../Cesium/Build/Cesium/Cesium.js"></script>
<script src="app.js"></script>
<script type="module">
    // Your access token can be found at: https://ion.cesium.com/tokens.
    // This is the default access token from your ion account
    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxMmM0MTUwOC05NmY0LTQwMTItYWIzOC1iMzc1NDE3NTA1NGUiLCJpZCI6MTY4ODk5LCJpYXQiOjE2OTU4MjI1NTF9.Z-ZN9FQT2U6ePjubwL12ErbDwMOxmftWD2gVvZXT_9Q';

    const viewer = new Cesium.Viewer('cesiumContainer', {
        baseLayerPicker: false,
        animation: false,
        timeline: false,
        sceneMode: false
    });
    const lasCrucesDowntown = viewer.entities.add({
        polygon: {
            hierarchy: Cesium.Cartesian3.fromDegreesArray([
                -106.78155502464388, 32.30548112792002,  // (Northwest corner)
                -106.77877131812703, 32.30406519916078,  // (Southwest corner)
                 -106.77796751323224, 32.304302447945574, //(Southeast corner)
                 -106.77806320429052, 32.305887685224654, //(Northeast corner)
            ]),
            height: 0,
            material: Cesium.Color.RED.withAlpha(0.2),
            outline: true,
            outlineColor: Cesium.Color.BLACK,
        },
    });

    // Fly the camera to Las Cruces at the given longitude, latitude, and height.
    const thunderforestTransportProvider = new Cesium.UrlTemplateImageryProvider({
        url: 'https://tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=9b491be8232441c8bbbca3e335a79bbb',
        credit: 'Map data © Thunderforest, © OpenStreetMap contributors',
        maximumLevel: 18 // Set the maximum level of detail as needed.
    });

    // Create an imagery layer using the Thunderforest Transport tile provider.
    const transportLayer = viewer.scene.imageryLayers.addImageryProvider(thunderforestTransportProvider);

    // Optionally, you can set layer properties like opacity and visibility.
    transportLayer.alpha = 1.0; // Set the opacity (0.0 to 1.0).
    transportLayer.show = true; // Show the layer.
    viewer.camera.flyTo({
        destination: Cesium.Cartesian3.fromDegrees(-106.7637, 32.3197, 10000),
        orientation: {
            heading: Cesium.Math.toRadians(0.0),
            pitch: Cesium.Math.toRadians(-90.0),
        }
    });

    const lcStartingPoint = viewer.entities.add({

        name: "Starting Point, Wells Fargo Building",
        position: Cesium.Cartesian3.fromDegrees( -106.77861221981614, 32.30526482854694),
        point: {
            pixelSize: 5,
            color: Cesium.Color.RED,
            OutlineColor: Cesium.Color.WHITE,
            outlineWidth: 2,
        },
        label: {
            text: "Las Cruces Tower",
            font: "14pt monospace",
            style: Cesium.LabelStyle.FILL_AND_OUTLINE,
            outlineWidth: 2,
            verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
            pixelOffset: new Cesium.Cartesian2(0, -9),
        }
        }



    )

    var infrantryUnit = viewer.entities.add({
        position: Cesium.Cartesian3.fromDegrees(-106.77802176389179, 32.305969917912826),
        billboard: {
            image: "../Cesium/Apps/SampleData/Infantry_NATO_APP-6.svg.png",
            show: true,
            width: 64,
            height: 32,
        },
        label: {
           // text: "Nato Infantry",
           // font: '16pt "Times New Roman"',
            style: Cesium.LabelStyle.FILL_AND_OUTLINE,
            fillColor: Cesium.Color.WHITE,
            outlineWidth: 2,
            verticalOrigin: Cesium.VerticalOrigin.TOP,
            pixelOffset: new Cesium.Cartesian2(0, 32),
        },


    })

    let colorCount = false;
    let buttonCount = false;
    let moveCount = false;
//Why are these counts working outside the function but not inside?
    function colorChange() {
       // var colorCount = 0;
        if (colorCount === false) {

            const myImageryLayer = new Cesium.ImageryLayer(
                new Cesium.OpenStreetMapImageryProvider({
                    url: "https://tile.openstreetmap.org/",
                })
            );


            viewer.scene.imageryLayers.add(myImageryLayer);
            LAYER_BUTTON.style.backgroundColor = 'red'
            colorCount = true;

        } else {
            const transportLayer = viewer.scene.imageryLayers.addImageryProvider(thunderforestTransportProvider)
            LAYER_BUTTON.style.backgroundColor = 'chartreuse'
            colorCount = false;
        }

    }

    function buttonHide(viewer) {
      //  var buttonCount = 0;
        console.log("Hide Button", buttonCount);
        if (buttonCount === false) {

            infrantryUnit.billboard.show = false;


            HIDE_BUTTON.style.backgroundColor = 'red'


            buttonCount = true;
        }

        else {
            infrantryUnit.billboard.show = true;
            HIDE_BUTTON.style.backgroundColor = 'coral'
            buttonCount = false;
        }


       // buttonHide(viewer);
    }
    function moveUnit(viewer) {
    if (moveCount === false) {
        infrantryUnit.position = Cesium.Cartesian3.fromDegrees(-106.77861221981614, 32.30526482854694)
        console.log("1st POS", infrantryUnit.position);
        MOVEBUTTON.style.backgroundColor = 'chartreuse';
        moveCount = true;
    }

        else {
        infrantryUnit.position = Cesium.Cartesian3.fromDegrees(-106.77802176389179, 32.305969917912826)
        console.log("2nd POS", infrantryUnit.position);
        MOVEBUTTON.style.backgroundColor = 'red';
        moveCount = false;
    }

    }

    function moveButtonNorth(viewer){


       let latLonPos = Cesium.Cartographic.fromCartesian(infrantryUnit.position.getValue(Cesium.JulianDate.now()));
       console.log("latlonPos", latLonPos);
       latLonPos.latitude += Cesium.Math.toRadians(.001);
        console.log("pos change", latLonPos.latitude)
       const newPosition = Cesium.Cartesian3.fromRadians(latLonPos.longitude, latLonPos.latitude, 0.0);

        infrantryUnit.position = newPosition;
    }

    function moveButtonSouth(){
        let latLonPos1 = Cesium.Cartographic.fromCartesian(infrantryUnit.position.getValue(Cesium.JulianDate.now()));
        console.log("latlonPos", latLonPos1);
        latLonPos1.latitude += Cesium.Math.toRadians(-.001);

        const newPosition = Cesium.Cartesian3.fromRadians(latLonPos1.longitude, latLonPos1.latitude, 0.0);
        infrantryUnit.position = newPosition;
    }
    function moveButtonEast(){
        let latLonPos1 = Cesium.Cartographic.fromCartesian(infrantryUnit.position.getValue(Cesium.JulianDate.now()));
        console.log("latlonPos", latLonPos1);
        latLonPos1.longitude += Cesium.Math.toRadians(.001);

        const newPosition = Cesium.Cartesian3.fromRadians(latLonPos1.longitude, latLonPos1.latitude, 0.0);
        infrantryUnit.position = newPosition;
    }
    function moveButtonWest(){
        let latLonPos1 = Cesium.Cartographic.fromCartesian(infrantryUnit.position.getValue(Cesium.JulianDate.now()));
        console.log("latlonPos", latLonPos1);
        latLonPos1.longitude += Cesium.Math.toRadians(-.001);

        const newPosition = Cesium.Cartesian3.fromRadians(latLonPos1.longitude, latLonPos1.latitude, 0.0);
        infrantryUnit.position = newPosition;
    }

    MOVE_BUTTON_NORTH.addEventListener('click', function () {
        moveButtonNorth(viewer);
        }
    );
    MOVE_BUTTON_SOUTH.addEventListener('click', (event) => {
        console.log(event)
        moveButtonSouth(viewer);
    });
    MOVE_BUTTON_EAST.addEventListener('click', (event) => {
        console.log(event)
        moveButtonEast(viewer);
    });
    MOVE_BUTTON_WEST.addEventListener('click', (event) => {
        console.log(event)
        moveButtonWest(viewer);
    });
    LAYER_BUTTON.addEventListener('click', function() {
        colorChange(viewer);
    });


    HIDE_BUTTON.addEventListener('click', function() {
        buttonHide(viewer);
    });

    MOVEBUTTON.addEventListener('click', function (){
        moveUnit(viewer)
    })
</script>
<script src="app.js"></script>
</body>
</html>
